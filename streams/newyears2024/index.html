<html>
<link href="./index.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Roboto:100,200,300,400,500,600,700,800,900,1000&display=swap"
    rel="stylesheet">
<link href="https://lcedit.com/odometer/odometer.css" rel="stylesheet">
<script src="https://lcedit.com/odometer/odometer.js"></script>

<body style="background-color: transparent; color: white;">
    <div class="main" id="main" style="margin-top: 7.5px; display: grid; grid-template-columns: repeat(5, 1fr);">
        <div class="column_1 column">
            <div class="card card_0" id="card_0">
                <div class="num" id="num_0">01</div>
                <img src="./blank.png" alt id="fire_0" class="fire">
                <img src="./default.png" alt id="image_0" class="image">
                <div class="name" id="name_0">Loading</div>
                <div class="count odometer" id="count_0">0</div>
            </div>
            <div class="card card_1" id="card_1">
                <div class="num" id="num_1">02</div>
                <img src="./blank.png" alt id="fire_1" class="fire">
                <img src="./default.png" alt id="image_1" class="image">
                <div class="name" id="name_1">Loading</div>
                <div class="count odometer" id="count_1">0</div>
            </div>
            <div class="card card_2" id="card_2">
                <div class="num" id="num_2">03</div>
                <img src="./blank.png" alt id="fire_2" class="fire">
                <img src="./default.png" alt id="image_2" class="image">
                <div class="name" id="name_2">Loading</div>
                <div class="count odometer" id="count_2">0</div>
            </div>
            <div class="card card_3" id="card_3">
                <div class="num" id="num_3">04</div>
                <img src="./blank.png" alt id="fire_3" class="fire">
                <img src="./default.png" alt id="image_3" class="image">
                <div class="name" id="name_3">Loading</div>
                <div class="count odometer" id="count_3">0</div>
            </div>
            <div class="card card_4" id="card_4">
                <div class="num" id="num_4">05</div>
                <img src="./blank.png" alt id="fire_4" class="fire">
                <img src="./default.png" alt id="image_4" class="image">
                <div class="name" id="name_4">Loading</div>
                <div class="count odometer" id="count_4">0</div>
            </div>
            <div class="card card_5" id="card_5">
                <div class="num" id="num_5">06</div>
                <img src="./blank.png" alt id="fire_5" class="fire">
                <img src="./default.png" alt id="image_5" class="image">
                <div class="name" id="name_5">Loading</div>
                <div class="count odometer" id="count_5">0</div>
            </div>
            <div class="card card_6" id="card_6">
                <div class="num" id="num_6">07</div>
                <img src="./blank.png" alt id="fire_6" class="fire">
                <img src="./default.png" alt id="image_6" class="image">
                <div class="name" id="name_6">Loading</div>
                <div class="count odometer" id="count_6">0</div>
            </div>
            <div class="card card_7" id="card_7">
                <div class="num" id="num_7">08</div>
                <img src="./blank.png" alt id="fire_7" class="fire">
                <img src="./default.png" alt id="image_7" class="image">
                <div class="name" id="name_7">Loading</div>
                <div class="count odometer" id="count_7">0</div>
            </div>
            <div class="card card_8" id="card_8">
                <div class="num" id="num_8">09</div>
                <img src="./blank.png" alt id="fire_8" class="fire">
                <img src="./default.png" alt id="image_8" class="image">
                <div class="name" id="name_8">Loading</div>
                <div class="count odometer" id="count_8">0</div>
            </div>
            <div class="card card_9" id="card_9">
                <div class="num" id="num_9">10</div>
                <img src="./blank.png" alt id="fire_9" class="fire">
                <img src="./default.png" alt id="image_9" class="image">
                <div class="name" id="name_9">Loading</div>
                <div class="count odometer" id="count_9">0</div>
            </div>
        </div>
        <div class="column_2 column">
            <div class="card card_10" id="card_10">
                <div class="num" id="num_10">11</div>
                <img src="./blank.png" alt id="fire_10" class="fire">
                <img src="./default.png" alt id="image_10" class="image">
                <div class="name" id="name_10">Loading</div>
                <div class="count odometer" id="count_10">0</div>
            </div>
            <div class="card card_11" id="card_11">
                <div class="num" id="num_11">12</div>
                <img src="./blank.png" alt id="fire_11" class="fire">
                <img src="./default.png" alt id="image_11" class="image">
                <div class="name" id="name_11">Loading</div>
                <div class="count odometer" id="count_11">0</div>
            </div>
            <div class="card card_12" id="card_12">
                <div class="num" id="num_12">13</div>
                <img src="./blank.png" alt id="fire_12" class="fire">
                <img src="./default.png" alt id="image_12" class="image">
                <div class="name" id="name_12">Loading</div>
                <div class="count odometer" id="count_12">0</div>
            </div>
            <div class="card card_13" id="card_13">
                <div class="num" id="num_13">14</div>
                <img src="./blank.png" alt id="fire_13" class="fire">
                <img src="./default.png" alt id="image_13" class="image">
                <div class="name" id="name_13">Loading</div>
                <div class="count odometer" id="count_13">0</div>
            </div>
            <div class="card card_14" id="card_14">
                <div class="num" id="num_14">15</div>
                <img src="./blank.png" alt id="fire_14" class="fire">
                <img src="./default.png" alt id="image_14" class="image">
                <div class="name" id="name_14">Loading</div>
                <div class="count odometer" id="count_14">0</div>
            </div>
            <div class="card card_15" id="card_15">
                <div class="num" id="num_15">16</div>
                <img src="./blank.png" alt id="fire_15" class="fire">
                <img src="./default.png" alt id="image_15" class="image">
                <div class="name" id="name_15">Loading</div>
                <div class="count odometer" id="count_15">0</div>
            </div>
            <div class="card card_16" id="card_16">
                <div class="num" id="num_16">17</div>
                <img src="./blank.png" alt id="fire_16" class="fire">
                <img src="./default.png" alt id="image_16" class="image">
                <div class="name" id="name_16">Loading</div>
                <div class="count odometer" id="count_16">0</div>
            </div>
            <div class="card card_17" id="card_17">
                <div class="num" id="num_17">18</div>
                <img src="./blank.png" alt id="fire_17" class="fire">
                <img src="./default.png" alt id="image_17" class="image">
                <div class="name" id="name_17">Loading</div>
                <div class="count odometer" id="count_17">0</div>
            </div>
            <div class="card card_18" id="card_18">
                <div class="num" id="num_18">19</div>
                <img src="./blank.png" alt id="fire_18" class="fire">
                <img src="./default.png" alt id="image_18" class="image">
                <div class="name" id="name_18">Loading</div>
                <div class="count odometer" id="count_18">0</div>
            </div>
            <div class="card card_19" id="card_19">
                <div class="num" id="num_19">20</div>
                <img src="./blank.png" alt id="fire_19" class="fire">
                <img src="./default.png" alt id="image_19" class="image">
                <div class="name" id="name_19">Loading</div>
                <div class="count odometer" id="count_19">0</div>
            </div>
        </div>
        <div class="column_3 column">
            <div class="card card_20" id="card_20">
                <div class="num" id="num_20">21</div>
                <img src="./blank.png" alt id="fire_20" class="fire">
                <img src="./default.png" alt id="image_20" class="image">
                <div class="name" id="name_20">Loading</div>
                <div class="count odometer" id="count_20">0</div>
            </div>
            <div class="card card_21" id="card_21">
                <div class="num" id="num_21">22</div>
                <img src="./blank.png" alt id="fire_21" class="fire">
                <img src="./default.png" alt id="image_21" class="image">
                <div class="name" id="name_21">Loading</div>
                <div class="count odometer" id="count_21">0</div>
            </div>
            <div class="card card_22" id="card_22">
                <div class="num" id="num_22">23</div>
                <img src="./blank.png" alt id="fire_22" class="fire">
                <img src="./default.png" alt id="image_22" class="image">
                <div class="name" id="name_22">Loading</div>
                <div class="count odometer" id="count_22">0</div>
            </div>
            <div class="card card_23" id="card_23">
                <div class="num" id="num_23">24</div>
                <img src="./blank.png" alt id="fire_23" class="fire">
                <img src="./default.png" alt id="image_23" class="image">
                <div class="name" id="name_23">Loading</div>
                <div class="count odometer" id="count_23">0</div>
            </div>
            <div class="card card_24" id="card_24">
                <div class="num" id="num_24">25</div>
                <img src="./blank.png" alt id="fire_24" class="fire">
                <img src="./default.png" alt id="image_24" class="image">
                <div class="name" id="name_24">Loading</div>
                <div class="count odometer" id="count_24">0</div>
            </div>
            <div class="card card_25" id="card_25">
                <div class="num" id="num_25">26</div>
                <img src="./blank.png" alt id="fire_25" class="fire">
                <img src="./default.png" alt id="image_25" class="image">
                <div class="name" id="name_25">Loading</div>
                <div class="count odometer" id="count_25">0</div>
            </div>
            <div class="card card_26" id="card_26">
                <div class="num" id="num_26">27</div>
                <img src="./blank.png" alt id="fire_26" class="fire">
                <img src="./default.png" alt id="image_26" class="image">
                <div class="name" id="name_26">Loading</div>
                <div class="count odometer" id="count_26">0</div>
            </div>
            <div class="card card_27" id="card_27">
                <div class="num" id="num_27">28</div>
                <img src="./blank.png" alt id="fire_27" class="fire">
                <img src="./default.png" alt id="image_27" class="image">
                <div class="name" id="name_27">Loading</div>
                <div class="count odometer" id="count_27">0</div>
            </div>
            <div class="card card_28" id="card_28">
                <div class="num" id="num_28">29</div>
                <img src="./blank.png" alt id="fire_28" class="fire">
                <img src="./default.png" alt id="image_28" class="image">
                <div class="name" id="name_28">Loading</div>
                <div class="count odometer" id="count_28">0</div>
            </div>
            <div class="card card_29" id="card_29">
                <div class="num" id="num_29">30</div>
                <img src="./blank.png" alt id="fire_29" class="fire">
                <img src="./default.png" alt id="image_29" class="image">
                <div class="name" id="name_29">Loading</div>
                <div class="count odometer" id="count_29">0</div>
            </div>
        </div>
        <div class="column_4 column">
            <div class="card card_30" id="card_30">
                <div class="num" id="num_30">31</div>
                <img src="./blank.png" alt id="fire_30" class="fire">
                <img src="./default.png" alt id="image_30" class="image">
                <div class="name" id="name_30">Loading</div>
                <div class="count odometer" id="count_30">0</div>
            </div>
            <div class="card card_31" id="card_31">
                <div class="num" id="num_31">32</div>
                <img src="./blank.png" alt id="fire_31" class="fire">
                <img src="./default.png" alt id="image_31" class="image">
                <div class="name" id="name_31">Loading</div>
                <div class="count odometer" id="count_31">0</div>
            </div>
            <div class="card card_32" id="card_32">
                <div class="num" id="num_32">33</div>
                <img src="./blank.png" alt id="fire_32" class="fire">
                <img src="./default.png" alt id="image_32" class="image">
                <div class="name" id="name_32">Loading</div>
                <div class="count odometer" id="count_32">0</div>
            </div>
            <div class="card card_33" id="card_33">
                <div class="num" id="num_33">34</div>
                <img src="./blank.png" alt id="fire_33" class="fire">
                <img src="./default.png" alt id="image_33" class="image">
                <div class="name" id="name_33">Loading</div>
                <div class="count odometer" id="count_33">0</div>
            </div>
            <div class="card card_34" id="card_34">
                <div class="num" id="num_34">35</div>
                <img src="./blank.png" alt id="fire_34" class="fire">
                <img src="./default.png" alt id="image_34" class="image">
                <div class="name" id="name_34">Loading</div>
                <div class="count odometer" id="count_34">0</div>
            </div>
            <div class="card card_35" id="card_35">
                <div class="num" id="num_35">36</div>
                <img src="./blank.png" alt id="fire_35" class="fire">
                <img src="./default.png" alt id="image_35" class="image">
                <div class="name" id="name_35">Loading</div>
                <div class="count odometer" id="count_35">0</div>
            </div>
            <div class="card card_36" id="card_36">
                <div class="num" id="num_36">37</div>
                <img src="./blank.png" alt id="fire_36" class="fire">
                <img src="./default.png" alt id="image_36" class="image">
                <div class="name" id="name_36">Loading</div>
                <div class="count odometer" id="count_36">0</div>
            </div>
            <div class="card card_37" id="card_37">
                <div class="num" id="num_37">38</div>
                <img src="./blank.png" alt id="fire_37" class="fire">
                <img src="./default.png" alt id="image_37" class="image">
                <div class="name" id="name_37">Loading</div>
                <div class="count odometer" id="count_37">0</div>
            </div>
            <div class="card card_38" id="card_38">
                <div class="num" id="num_38">39</div>
                <img src="./blank.png" alt id="fire_38" class="fire">
                <img src="./default.png" alt id="image_38" class="image">
                <div class="name" id="name_38">Loading</div>
                <div class="count odometer" id="count_38">0</div>
            </div>
            <div class="card card_39" id="card_39">
                <div class="num" id="num_39">40</div>
                <img src="./blank.png" alt id="fire_39" class="fire">
                <img src="./default.png" alt id="image_39" class="image">
                <div class="name" id="name_39">Loading</div>
                <div class="count odometer" id="count_39">0</div>
            </div>
        </div>
    </div>
</body>
<script>
    odometers = Odometer.init();
    for (let i = 0; i < 40; i++) {
        odometers[i].options = {
            animation: "minimal",
            downColor: "white",
            duration: 0.5 * 1000,
            removeLeadingZeros: true,
            reverseAnimation: false,
            format: "dddd:ddd:dd:dd:dd:dd",
            upColor: "white"
        }
    }

function padZero(number) {
    return String(number).padStart(2, '0');
}

    setInterval(() => {
        fetch(`./timezones.json`)
            .then((res) => res.json())
            .then((data) => {
                let timezones = [];
                const currentDate = new Date();
                console.log("Current Date: ", currentDate);

                // Calculate the count for each timezone and the time until 2025
                for (let i = 0; i < data.timezones.length; i++) {
                    let timezone = data.timezones[i];

                    if (!timezone || !timezone.timezone || !timezone.flags || !Array.isArray(timezone.flags)) {
                        console.warn(`Skipping invalid timezone at index ${i}:`, timezone);
                        continue; // Skip invalid entries
                    }

                    // Parse the timezone offset (e.g., "UTC+05:30")
                    let offsetStr = timezone.timezone; // Full timezone string like "UTC+05:30" or "UTC-03:00"
                    let sign = offsetStr.charAt(3) === '-' ? -1 : 1; // Determine if it's positive or negative offset
                    let offsetParts = offsetStr.slice(4).split(":"); // Get the hour and minute parts
                    let offsetHours = parseInt(offsetParts[0]) || 0; // Default to 0 if not provided
                    let offsetMinutes = parseInt(offsetParts[1]) || 0; // Default to 0 if not provided

                    let totalOffsetMinutes = sign * (offsetHours * 60 + offsetMinutes); // Convert to total minutes

                    if (isNaN(totalOffsetMinutes)) {
                        console.warn(`Invalid offset at index ${i}:`, timezone.timezone);
                        continue;
                    }

                    // Target date in UTC
                    let targetDate = new Date("2025-01-01T00:00:00Z"); // Set target date to Jan 1, 2025 in UTC
                    targetDate.setMinutes(targetDate.getMinutes() - totalOffsetMinutes); // Adjust the target date by the offset in minutes

                    // Log the calculation of target date and offset
                    console.log(`Timezone: ${timezone.timezone}, Offset in minutes: ${totalOffsetMinutes}, Target Date Adjusted: ${targetDate}`);

                    // Calculate the time difference in milliseconds
                    let timeDiff = targetDate - currentDate;

                    // Log the time difference for debugging
                    console.log(`Time Diff for ${timezone.timezone}: ${timeDiff} milliseconds`);

                    // Ensure timeDiff is valid
                    if (isNaN(timeDiff)) {
                        console.warn(`Invalid time difference for timezone ${timezone.timezone}`);
                        continue;
                    }

                    // Manually calculate the days, hours, minutes, and seconds
                    let daysUntil2025 = Math.floor(timeDiff / (1000 * 60 * 60 * 24));
                    let hoursUntil2025 = Math.floor((timeDiff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    let minutesUntil2025 = Math.floor((timeDiff % (1000 * 60 * 60)) / (1000 * 60));
                    let secondsUntil2025 = Math.floor((timeDiff % (1000 * 60)) / 1000);

                    // Log the calculated breakdown
                    console.log(`Days: ${daysUntil2025}, Hours: ${hoursUntil2025}, Minutes: ${minutesUntil2025}, Seconds: ${secondsUntil2025}`);

                    // Format the countdown as "DDHHMMSS" (Days, Hours, Minutes, Seconds)
                    let timeLeft = `${padZero(daysUntil2025)}${padZero(hoursUntil2025)}${padZero(minutesUntil2025)}${padZero(secondsUntil2025)}`;
                    console.log(`Formatted Countdown for ${timezone.timezone}: ${timeLeft}`);

                    // Store the valid data for each timezone
                    timezones[i] = {
                        offset: timezone.timezone,  // Store the offset in "UTC+X" format
                        flags: timezone.flags.map(flag => flag.flag_url), // Assuming flags contains URLs
                        count: totalOffsetMinutes,
                        timeUntil2025: timeLeft,  // Time remaining until 2025 in the "DDHHMMSS" format
                        timeDiff: timeDiff  // Save the time difference to categorize passed/not passed
                    };
                }

                // Filter out invalid entries
                timezones = timezones.filter(tz => tz && tz.timeDiff !== undefined);
                console.log("Valid Timezones: ", timezones);

                // Sort timezones by timeDiff (earliest time first)
                timezones.sort((a, b) => a.timeDiff - b.timeDiff);  // Fix sorting by time difference
                console.log("Sorted Timezones: ", timezones);

                // Categorize timezones into passed and not passed
                let passedTimezones = timezones.filter(tz => tz.timeDiff < 0); // Timezones that have already passed
                let notPassedTimezones = timezones.filter(tz => tz.timeDiff >= 0); // Timezones that haven't passed yet
                console.log("Passed Timezones: ", passedTimezones);
                console.log("Not Passed Timezones: ", notPassedTimezones);

                let variable1 = notPassedTimezones.length; // Timezones with time remaining until 2025
                let variable2 = passedTimezones.length;    // Timezones that have already passed

                // Update UI with sorted timezones and alternating flags
                for (let i = 0; i < 40; i++) {
                    let timezone = timezones[i];
                    if (timezone) {  // Check if timezone is valid
                        if (timezone.timeDiff >= 0) {
                            // Timezone hasn't passed yet, update the first set of images
                            let imageElement = document.getElementById(`image_${i}`);
                            let nameElement = document.getElementById(`name_${i}`);
                            let countElement = document.getElementById(`count_${i}`);
                            if (imageElement) imageElement.src = timezone.flags[i % timezone.flags.length];
                            if (nameElement) nameElement.textContent = timezone.offset;  // Show the offset (e.g., "UTC+08:00")
                            if (countElement) countElement.innerHTML = timezone.timeUntil2025;  // Show the formatted countdown
                        } else {
                            // Timezone has already passed, update the second set of images
                            let imageElement = document.getElementById(`image_${i}`);
                            let nameElement = document.getElementById(`name_${i}`);
                            let countElement = document.getElementById(`count_${i}`);
                            if (imageElement) imageElement.src = timezone.flags[i % timezone.flags.length];
                            if (nameElement) nameElement.textContent = timezone.offset;  // Show the offset (e.g., "UTC+08:00")
                            if (countElement) countElement.innerHTML = 0;  // Show the formatted countdown
                        }
                    }
                }
            })
            .catch((error) => {
                console.error("Error fetching or parsing timezones:", error);
            });
    }, 1000);

</script>

</html>
